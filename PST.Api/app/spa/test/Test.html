
<div class="container is-scrollable">
    <div class="test">
        <div class="test-head">
            <h2>{{test.test_name}}</h2>

            <div class="test-progress">
                <span class="test-progress-percent">{{ progress() }}</span>

						<span class="test-progress-label">
							Test Completed
						</span><!-- /.test-progress-label -->

                <div class="test-progress-bar">
                    <div class="test-progress-bar-fill" style="width: {{ progress() }}"></div><!-- /.test-progress-bar-fill -->
                </div><!-- /.test-progress-bar -->
            </div><!-- /.test-progress -->
        </div><!-- /.test-head -->

        <div class="test-body">

            <!-- Showing test questions -->
            <div class="cols clearfix" ng-if="result == null">
                <div class="col col-1of2">
                    <div class="test-question">
                        <h3 class="test-question-title">{{question.question_text}}</h3><!-- /.test-question-title -->
                    </div><!-- /.test-question -->
                </div><!-- /.col col-1of2 -->

                <div class="col col-1of2">
                    <div class="test-question-answers">
                        <div class="form-body">


                            <!-- TODO image options? -->


                            <div class="course-question-options" ng-class="question.correct == null ? '' : question.correct.correct ? 'correct' : 'retry'">
                                <div class="course-question-option course-question-option-header" ng-if="question.correct != null">
                                    {{question.correct.correct ? question.correct.correct_response_heading : 'Retry'}}
                                </div>

                                <div>
                                    <div class="course-question-option" ng-repeat="option in question.options" ng-if="!question.correct.correct" >

                                        <input type="checkbox" id="option{{$index}}" value="{{option.option_id}}" ng-model="model.answer[$index]" ng-if="question.multi_select">
                                        <input type="radio" id="option{{$index}}" value="{{option.option_id}}" ng-model="model.answer[0]" ng-if="!question.multi_select">

                                        <label for="option{{$index}}">{{option.text}}</label>
                                    </div><!-- /.course-question-option -->
                                </div>

                                <div class="course-question-option" ng-repeat="option in question.options | filter:hasIdIn(model.answer)" ng-if="question.correct.correct" >

                                    <input type="radio" checked="checked">

                                    <label for="option{{$index}}">{{option.text}}</label>
                                </div><!-- /.course-question-option -->

                                <div class="course-question-option-description" ng-if="question.correct.correct">
                                    {{ question.correct.correct_response_text }}
                                </div><!-- /.course-question-option -->
                            </div><!-- /.course-questions-options -->
                        </div><!-- /.form-body -->

                        <div class="form-actions">
                            <input type="button" class="btn" value="{{question.correct.correct ? 'Continue' : 'Answer'}}" ng-click="next()" ng-disabled="model.answer == null" ng-if="!lastQuestion()">
                            <input type="button" class="btn" value="Grade Test!" ng-click="submit()" ng-if="lastQuestion()">
                        </div><!-- /.form-actions -->
                    </div><!-- /.test-question-answers -->
                </div><!-- /.col col-1of2 -->
            </div><!-- /.cols -->

            <!-- Test result failed -->
            <div class="cols" ng-if="result != null && result.passed != 1">
                <div class="col col-1of2">
                    <div class="test-certificate">
                        <div class="test-certificate-title">
                            You answered {{ length(result.corrects) }} out of {{test.questions.length}} questions correctly.
                            <div ng-if="round < 3">
                                You may review your answers and try again.
                            </div>
                        </div>
                    </div><!-- /.test-certificate -->
                </div><!-- /.col col-1of2 -->

                <div class="col col-1of2">
                    <div class="test-certificate-form" ng-if="round < 3">
                        <div class="form-head">
                            <h4 class="form-title">Would you like to try again?</h4><!-- /.form-title -->
                        </div><!-- /.form-head -->

                        <!-- TODO This is mock text -->
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam sed mattis ligula. Pellentesque pretium dictum purus, ut venenatis velit dictum in. Pellentesque eu mi eu nisl tincidunt molestie. Aliquam pretium eros ante, a mollis nunc fermentum nec. In a facilisis lectus.

                        <div class="form-actions">
                            <button class="btn btn-lightgray" ng-click="$state.go('dashboard')" >No Thanks!</button>
                            <button class="btn btn-green" ng-click="nextRound()">{{round == 1 ? 'Retake Test' : 'Retake Missed Questions'}}</button>

                            <!--<input type="submit" value="Retry Missed Questions" class="btn btn-green">-->
                        </div><!-- /.form-actions -->
                    </div><!-- /.test-certificate-form -->
                    <div class="test-certificate-form" ng-if="round >= 3">
                        <div class="form-head">
                            <h4 class="form-title"></h4><!-- /.form-title -->
                        </div><!-- /.form-head -->

                        <div class="form-actions">
                            <button class="btn btn-lightgray" ng-click="$state.go('dashboard')" >Go back</button>
                        </div><!-- /.form-actions -->
                    </div><!-- /.test-certificate-form -->
                </div><!-- /.col col-1of2 -->
            </div><!-- /.cols -->

            <!-- Test result passed -->
            <div class="cols" ng-if="result != null && result.passed == 1">


                <div class="col col-1of2">
                    <div class="test-certificate">
                        <h4 class="test-certificate-title">Congratulations!</h4>
                        <h4 class="test-certificate-title">You've completed the "{{test.title}}" module.</h4><!-- /.test-certificate-title -->
                    </div><!-- /.test-certificate -->
                </div><!-- /.col col-1of2 -->

                <div class="col col-1of2">

                    <submit-ceu/>

                </div><!-- /.col col-1of2 -->

            </div><!-- /.cols -->
        </div><!-- /.test-body -->
    </div><!-- /.test -->
</div><!-- /.container -->
